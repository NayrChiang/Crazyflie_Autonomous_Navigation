import inspect
import json
import matplotlib as mpl
from matplotlib.lines import Line2D
import matplotlib.pyplot as plt
import numpy as np
from pathlib import Path
from scipy.spatial.transform import Rotation
import time

from flightsim.animate import animate
from flightsim.axes3ds import Axes3Ds
from flightsim.crazyflie_params import quad_params
from flightsim.simulate import Quadrotor, simulate, ExitStatus
from flightsim.world import World

from proj1_3.code.occupancy_map import OccupancyMap
from proj1_3.code.se3_control import SE3Control
from proj1_3.code.world_traj import WorldTraj

# Improve figure display on high DPI screens.
# mpl.rcParams['figure.dpi'] = 120

# Choose a test example file. You should write your own example files too!
# filename = '../util/test_window.json'
filename = '../util/test_maze.json'
# filename = '../util/test_over_under.json'
# filename = '../util/mymap.json'
# filename = '../util/maze_2022_1.json'
# filename = '../util/maze_2022_2.json'
# filename = '../util/maze_2022_3.json'
# filename = '../util/maze_2024_1.json'
# filename = '../util/maze_2024_2.json'
# filename = '../util/maze_2024_3.json'

# Load the test example.
file = Path(inspect.getsourcefile(lambda:0)).parent.resolve() / '..' / 'util' / filename
world = World.from_file(file)          # World boundary and obstacles.
start  = world.world['start']          # Start point, shape=(3,)
goal   = world.world['goal']           # Goal point, shape=(3,)

# This object defines the quadrotor dynamical model and should not be changed.
quadrotor = Quadrotor(quad_params)
robot_radius = 0.25

# Your SE3Control object (from project 1-1).
my_se3_control = SE3Control(quad_params)

# Your MapTraj object. This behaves like the trajectory function you wrote in
# project 1-1, except instead of giving it waypoints you give it the world,
# start, and goal.
planning_start_time = time.time()
my_world_traj = WorldTraj(world, start, goal)
planning_end_time = time.time()

# Help debug issues you may encounter with your choice of resolution and margin
# by plotting the occupancy grid after inflation by margin. THIS IS VERY SLOW!!
# fig = plt.figure('world')
# ax = Axes3Ds(fig)
# world.draw(ax)
# fig = plt.figure('occupancy grid')
# ax = Axes3Ds(fig)
# resolution = SET YOUR RESOLUTION HERE
# margin = SET YOUR MARGIN HERE
# oc = OccupancyMap(world, resolution, margin)
# oc.draw(ax)
# ax.plot([start[0]], [start[1]], [start[2]], 'go', markersize=10, markeredgewidth=3, markerfacecolor='none')
# ax.plot( [goal[0]],  [goal[1]],  [goal[2]], 'ro', markersize=10, markeredgewidth=3, markerfacecolor='none')
# plt.show()

# Set simulation parameters.
t_final = 60
initial_state = {'x': start,
                 'v': (0, 0, 0),
                 'q': (0, 0, 0, 1), # [i,j,k,w]
                 'w': (0, 0, 0)}

# Perform simulation.
#
# This function performs the numerical simulation.  It returns arrays reporting
# the quadrotor state, the control outputs calculated by your controller, and
# the flat outputs calculated by you trajectory.

print()
print('Simulate.')
(sim_time, state, control, flat, exit) = simulate(initial_state,
                                              quadrotor,
                                              my_se3_control,
                                              my_world_traj,
                                              t_final)
print(exit.value)

# Print results.
#
# Only goal reached, collision test, and flight time are used for grading.

collision_pts = world.path_collisions(state['x'], robot_radius)

stopped_at_goal = (exit == ExitStatus.COMPLETE) and np.linalg.norm(state['x'][-1] - goal) <= 0.05
no_collision = collision_pts.size == 0
flight_time = sim_time[-1]
flight_distance = np.sum(np.linalg.norm(np.diff(state['x'], axis=0),axis=1))
planning_time = planning_end_time - planning_start_time

print()
print(f"Results:")
print(f"  No Collision:    {'pass' if no_collision else 'FAIL'}")
print(f"  Stopped at Goal: {'pass' if stopped_at_goal else 'FAIL'}")
print(f"  Flight time:     {flight_time:.1f} seconds")
print(f"  Flight distance: {flight_distance:.1f} meters")
print(f"  Planning time:   {planning_time:.1f} seconds")
if not no_collision:
    print()
    print(f"  The robot collided at location {collision_pts[0]}!")

# Plot Results
#
# You will need to make plots to debug your quadrotor.
# Here are some example of plots that may be useful.

# Visualize the original dense path from A*, your sparse waypoints, and the
# smooth trajectory.


fig = plt.figure('A* Path, Waypoints, and Trajectory')
ax = Axes3Ds(fig)
world.draw(ax)
ax.plot([start[0]], [start[1]], [start[2]], 'go', markersize=16, markeredgewidth=3, markerfacecolor='none')
ax.plot( [goal[0]],  [goal[1]],  [goal[2]], 'ro', markersize=16, markeredgewidth=3, markerfacecolor='none')
if hasattr(my_world_traj, 'path'):
    if my_world_traj.path is not None:
        world.draw_line(ax, my_world_traj.path, color='red', linewidth=1)
else:
    print("Have you set \'self.path\' in WorldTraj.__init__?")
if hasattr(my_world_traj, 'points'):
    if my_world_traj.points is not None:
        world.draw_points(ax, my_world_traj.points, color='purple', markersize=8)
else:
    print("Have you set \'self.points\' in WorldTraj.__init__?")
world.draw_line(ax, flat['x'], color='black', linewidth=2)

# Maze 1 .bag xyz
# x = [-1.6934,-1.6933,-1.6933,-1.6934,-1.6932,-1.6933,-1.6932,-1.6931,-1.6927,-1.6924,-1.6923,-1.692,-1.6917,-1.6914,-1.6912,-1.6911,-1.691,-1.6907,-1.6905,-1.6901,-1.6899,-1.6896,-1.6894,-1.6891,-1.6888,-1.6886,-1.6884,-1.6881,-1.6878,-1.6876,-1.6873,-1.6872,-1.687,-1.6867,-1.6865,-1.6863,-1.6861,-1.6859,-1.6857,-1.6856,-1.6853,-1.6852,-1.6851,-1.685,-1.6849,-1.6847,-1.6846,-1.6845,-1.6844,-1.6843,-1.6841,-1.684,-1.684,-1.6839,-1.6838,-1.6838,-1.6837,-1.6837,-1.6836,-1.6836,-1.6837,-1.6837,-1.6838,-1.6839,-1.684,-1.6841,-1.6842,-1.6843,-1.6849,-1.6853,-1.6857,-1.6861,-1.6864,-1.6865,-1.6868,-1.6871,-1.6874,-1.6878,-1.6882,-1.6885,-1.6887,-1.689,-1.6893,-1.6897,-1.69,-1.6903,-1.6908,-1.691,-1.6913,-1.6916,-1.6918,-1.6917,-1.6922,-1.6923,-1.6924,-1.6925,-1.6926,-1.6925,-1.6925,-1.6922,-1.692,-1.6918,-1.6916,-1.6911,-1.6908,-1.6899,-1.6894,-1.6888,-1.6882,-1.6876,-1.6868,-1.6861,-1.6847,-1.6839,-1.6828,-1.6814,-1.6801,-1.6787,-1.677,-1.6753,-1.6736,-1.672,-1.6696,-1.6677,-1.6651,-1.6628,-1.6606,-1.6577,-1.6547,-1.6517,-1.6486,-1.6455,-1.6423,-1.6383,-1.635,-1.6309,-1.6269,-1.6228,-1.6182,-1.614,-1.6097,-1.6051,-1.5851,-1.5677,-1.5571,-1.5464,-1.5392,-1.5332,-1.5275,-1.5213,-1.5135,-1.5058,-1.4979,-1.4901,-1.4818,-1.4741,-1.4666,-1.4576,-1.4494,-1.4415,-1.4344,-1.4253,-1.4182,-1.4094,-1.4023,-1.3939,-1.3859,-1.3776,-1.3702,-1.3621,-1.3525,-1.344,-1.3352,-1.3267,-1.317,-1.3077,-1.2981,-1.2906,-1.2804,-1.2707,-1.2609,-1.2525,-1.2422,-1.2325,-1.2226,-1.2128,-1.2029,-1.1924,-1.1835,-1.1729,-1.1619,-1.1521,-1.1421,-1.1328,-1.1214,-1.1101,-1.1009,-1.0899,-1.081,-1.0691,-1.0599,-1.0471,-1.0321,-1.0209,-1.0068,-0.9945,-0.9861,-0.9745,-0.9653,-0.9545,-0.9435,-0.934,-0.9255,-0.9143,-0.904,-0.8945,-0.8852,-0.8756,-0.8674,-0.8579,-0.8486,-0.8397,-0.831,-0.822,-0.8143,-0.8053,-0.7966,-0.7894,-0.7808,-0.7724,-0.7649,-0.757,-0.7507,-0.7423,-0.7347,-0.7275,-0.7202,-0.7132,-0.7067,-0.7007,-0.6935,-0.6867,-0.6804,-0.6754,-0.6685,-0.6628,-0.6576,-0.6518,-0.6462,-0.6411,-0.6362,-0.6309,-0.6271,-0.6221,-0.6175,-0.6138,-0.6095,-0.6056,-0.6016,-0.5984,-0.595,-0.5921,-0.5886,-0.5854,-0.5833,-0.5806,-0.5782,-0.5758,-0.5735,-0.5716,-0.5697,-0.5679,-0.5669,-0.5656,-0.5642,-0.5633,-0.5624,-0.5615,-0.5612,-0.561,-0.5608,-0.5607,-0.5606,-0.5608,-0.5613,-0.5617,-0.5623,-0.563,-0.5641,-0.565,-0.5662,-0.5675,-0.569,-0.5703,-0.5721,-0.5742,-0.5761,-0.5782,-0.5803,-0.5828,-0.5849,-0.5878,-0.5905,-0.5934,-0.5963,-0.5994,-0.6022,-0.6056,-0.6094,-0.6125,-0.6165,-0.6201,-0.6236,-0.6277,-0.6318,-0.636,-0.6394,-0.6443,-0.6484,-0.6531,-0.657,-0.6623,-0.6669,-0.6713,-0.6765,-0.6815,-0.6865,-0.6915,-0.6968,-0.7022,-0.7099,-0.7176,-0.723,-0.7294,-0.7352,-0.7405,-0.746,-0.7509,-0.7577,-0.7633,-0.7693,-0.7747,-0.7811,-0.7872,-0.7932,-0.7991,-0.8056,-0.8109,-0.8177,-0.8229,-0.83,-0.8359,-0.842,-0.8485,-0.8546,-0.8607,-0.8676,-0.8743,-0.8798,-0.8864,-0.8928,-0.8997,-0.9054,-0.9111,-0.9187,-0.9245,-0.9313,-0.938,-0.9439,-0.95,-0.9569,-0.9635,-0.9692,-0.9758,-0.9822,-0.9886,-0.9948,-1.0013,-1.0069,-1.0131,-1.0199,-1.0256,-1.0315,-1.0371,-1.0438,-1.0502,-1.0551,-1.0613,-1.0675,-1.0732,-1.0793,-1.0984,-1.1087,-1.1048,-1.1064,-1.1113,-1.117,-1.1226,-1.1283,-1.1326,-1.1383,-1.1431,-1.1472,-1.1524,-1.1569,-1.1613,-1.1654,-1.1694,-1.1733,-1.1771,-1.1809,-1.1847,-1.1878,-1.1916,-1.1953,-1.1982,-1.2016,-1.2046,-1.2077,-1.2103,-1.2129,-1.2154,-1.2181,-1.2204,-1.2227,-1.2249,-1.2271,-1.2289,-1.2309,-1.2325,-1.2341,-1.2357,-1.2371,-1.2385,-1.2398,-1.2407,-1.2417,-1.2425,-1.2433,-1.2439,-1.2445,-1.245,-1.2454,-1.2457,-1.2458,-1.2459,-1.246,-1.2459,-1.2456,-1.2453,-1.245,-1.2445,-1.244,-1.2434,-1.2427,-1.2419,-1.2411,-1.2401,-1.2391,-1.2381,-1.2368,-1.2356,-1.2345,-1.2329,-1.2316,-1.2299,-1.2286,-1.2271,-1.2254,-1.2237,-1.222,-1.2203,-1.2185,-1.2167,-1.2147,-1.213,-1.2114,-1.2093,-1.2074,-1.2055,-1.204,-1.2019,-1.2003,-1.1986,-1.1967,-1.1949,-1.1931,-1.1916,-1.1898,-1.1883,-1.1864,-1.1849,-1.1836,-1.1817,-1.1805,-1.179,-1.1775,-1.176,-1.1748,-1.1737,-1.1727,-1.1714,-1.1699,-1.1685,-1.1674,-1.1663,-1.1655,-1.1644,-1.1634,-1.1624,-1.1615,-1.1607,-1.1599,-1.1593,-1.1585,-1.1578,-1.1573,-1.1568,-1.1563,-1.1557,-1.1554,-1.1549,-1.1545,-1.1541,-1.1538,-1.1536,-1.1534,-1.1531,-1.153,-1.1529,-1.1528,-1.1527,-1.1527,-1.1527,-1.1526,-1.1527,-1.1528,-1.1528,-1.153,-1.1531,-1.1532,-1.1533,-1.1536,-1.1539,-1.154,-1.1543,-1.1545,-1.1548,-1.155,-1.1553,-1.1556,-1.1559,-1.1563,-1.1567,-1.157,-1.1574,-1.1578,-1.1581,-1.1584,-1.159,-1.1593,-1.1597,-1.1601,-1.1605,-1.1609,-1.1613,-1.1617,-1.1622,-1.1626,-1.163,-1.1635,-1.1639,-1.1643,-1.1647,-1.1651,-1.1656,-1.1659,-1.1663,-1.1666,-1.1671,-1.1675,-1.1678,-1.1683,-1.1687,-1.1691,-1.1694,-1.1699,-1.1702,-1.1705,-1.1708,-1.1712,-1.1716,-1.1719,-1.1722,-1.1726,-1.1729,-1.1732,-1.1735,-1.1738,-1.1742,-1.1745,-1.1749,-1.1751,-1.1753,-1.1756,-1.1759,-1.1762,-1.1765,-1.1768,-1.177,-1.1773,-1.1774,-1.1776,-1.1779,-1.1782,-1.1784,-1.1787,-1.179,-1.1792,-1.1794,-1.1797,-1.1799,-1.1802,-1.1804,-1.1805,-1.1814,-1.1819,-1.1822,-1.1823,-1.1824,-1.1825,-1.1827,-1.1828,-1.1829,-1.183,-1.1833,-1.1834,-1.1836,-1.1837,-1.1838,-1.184,-1.1841,-1.1843,-1.1844,-1.1846,-1.1847,-1.1848,-1.1849,-1.185,-1.1851,-1.1852,-1.1854,-1.1854,-1.1855,-1.1856,-1.1856,-1.1856,-1.1856,-1.1855,-1.1854,-1.1854,-1.1853,-1.1852,-1.1851,-1.1849,-1.1848,-1.1848,-1.1846,-1.1844,-1.1842,-1.184,-1.1839,-1.1837,-1.1835,-1.1834,-1.1831,-1.1828,-1.1828,-1.1824,-1.1818,-1.1815,-1.1809,-1.1804,-1.1802,-1.1802,-1.18,-1.1799,-1.1798,-1.1797,-1.1795,-1.1794,-1.1792,-1.1791,-1.179,-1.179,-1.1789,-1.1788,-1.1788,-1.1787,-1.1785,-1.1785,-1.1785,-1.1786,-1.1786,-1.1786,-1.1786,-1.1786,-1.1786,-1.1787,-1.1787,-1.1788,-1.1789,-1.179,-1.1792,-1.1793,-1.1793,-1.1794,-1.1795,-1.1797,-1.1798,-1.1799,-1.1801,-1.1803,-1.1804,-1.1806,-1.1806,-1.1808,-1.181,-1.1811,-1.1814,-1.1815,-1.1816,-1.1818,-1.1819,-1.182,-1.1822,-1.1823,-1.1825,-1.1826,-1.1826,-1.1827,-1.1829,-1.183,-1.1831,-1.1831,-1.1832,-1.1833,-1.1834,-1.1835,-1.1836]
# y = [-1.4217,-1.4216,-1.4216,-1.4214,-1.421,-1.4209,-1.4208,-1.4206,-1.4199,-1.4189,-1.4187,-1.4185,-1.4183,-1.4181,-1.4178,-1.4176,-1.4173,-1.417,-1.4167,-1.4163,-1.4159,-1.4155,-1.4153,-1.415,-1.4147,-1.4143,-1.414,-1.4137,-1.4131,-1.4128,-1.4126,-1.4124,-1.4122,-1.4119,-1.4116,-1.4114,-1.4111,-1.4109,-1.4106,-1.4104,-1.4101,-1.41,-1.4097,-1.4096,-1.4094,-1.4093,-1.4091,-1.4091,-1.4089,-1.4089,-1.4088,-1.4087,-1.4088,-1.4088,-1.4087,-1.4087,-1.4086,-1.4085,-1.4081,-1.408,-1.4078,-1.4074,-1.4069,-1.4063,-1.4054,-1.4048,-1.4037,-1.4022,-1.3969,-1.3938,-1.3913,-1.3887,-1.3863,-1.3844,-1.3821,-1.3794,-1.3761,-1.3729,-1.3693,-1.366,-1.3614,-1.3578,-1.3538,-1.3485,-1.3447,-1.3394,-1.3341,-1.3294,-1.3236,-1.3192,-1.3131,-1.3072,-1.301,-1.2941,-1.2884,-1.2821,-1.276,-1.2694,-1.263,-1.2561,-1.2494,-1.2415,-1.2341,-1.2262,-1.2201,-1.2111,-1.2046,-1.1959,-1.1875,-1.1791,-1.1715,-1.1638,-1.1539,-1.1468,-1.1375,-1.1279,-1.1197,-1.1114,-1.1019,-1.092,-1.083,-1.0753,-1.0643,-1.0556,-1.0459,-1.0366,-1.0284,-1.0182,-1.0082,-0.9986,-0.9891,-0.9802,-0.9715,-0.9608,-0.9522,-0.9422,-0.9328,-0.9235,-0.9138,-0.9053,-0.8967,-0.8845,-0.8502,-0.8238,-0.8086,-0.7941,-0.786,-0.7794,-0.7733,-0.7672,-0.7591,-0.7511,-0.743,-0.7355,-0.7274,-0.7203,-0.7138,-0.7063,-0.6996,-0.6936,-0.6886,-0.6815,-0.6763,-0.6704,-0.6659,-0.6604,-0.6551,-0.6495,-0.6451,-0.6403,-0.6346,-0.6298,-0.6248,-0.62,-0.6149,-0.6102,-0.605,-0.6014,-0.5966,-0.5922,-0.5878,-0.584,-0.5792,-0.5751,-0.5708,-0.5669,-0.5628,-0.5586,-0.5551,-0.5511,-0.5468,-0.543,-0.5392,-0.5358,-0.5317,-0.5276,-0.5243,-0.5204,-0.5172,-0.5131,-0.51,-0.5053,-0.4999,-0.4962,-0.4915,-0.4871,-0.4842,-0.4802,-0.4769,-0.4731,-0.4692,-0.4656,-0.4626,-0.4587,-0.4547,-0.4511,-0.4475,-0.4438,-0.4406,-0.4368,-0.433,-0.4292,-0.4255,-0.4215,-0.418,-0.4137,-0.4096,-0.406,-0.4017,-0.3973,-0.3932,-0.3885,-0.3849,-0.38,-0.3751,-0.3705,-0.3656,-0.3609,-0.3561,-0.3516,-0.346,-0.3405,-0.3352,-0.3309,-0.3247,-0.3193,-0.3141,-0.3081,-0.3021,-0.2963,-0.2905,-0.2839,-0.2789,-0.2722,-0.2655,-0.2599,-0.2531,-0.2464,-0.2393,-0.2332,-0.2263,-0.22,-0.2121,-0.2044,-0.1987,-0.1907,-0.1833,-0.1757,-0.1675,-0.1601,-0.1524,-0.1444,-0.137,-0.1291,-0.1203,-0.1122,-0.1039,-0.095,-0.0877,-0.0795,-0.0706,-0.0614,-0.0529,-0.044,-0.0353,-0.0263,-0.0171,-0.0091,0.0009,0.0091,0.0188,0.0283,0.038,0.0456,0.0558,0.0655,0.0751,0.0848,0.0932,0.1042,0.1119,0.1226,0.1324,0.142,0.1516,0.1617,0.1702,0.1806,0.1911,0.1995,0.2102,0.2197,0.229,0.2392,0.2492,0.2596,0.2675,0.2787,0.2878,0.2987,0.3068,0.3177,0.3273,0.3364,0.3467,0.3566,0.3662,0.3755,0.3859,0.3961,0.4091,0.4228,0.4318,0.4423,0.4519,0.4605,0.4699,0.4776,0.4883,0.4966,0.5055,0.5137,0.5232,0.5319,0.5405,0.5487,0.5576,0.5649,0.5743,0.5809,0.5904,0.598,0.6058,0.6138,0.6211,0.6284,0.6367,0.6445,0.651,0.6586,0.6659,0.6738,0.6802,0.6861,0.6941,0.7003,0.7076,0.7145,0.7206,0.7266,0.7334,0.7401,0.7457,0.752,0.7582,0.7641,0.7698,0.7758,0.7809,0.7865,0.7921,0.797,0.8021,0.8067,0.8123,0.8177,0.8217,0.8268,0.8317,0.8362,0.8412,0.8287,0.8296,0.8538,0.8623,0.8685,0.872,0.8751,0.8787,0.8816,0.8857,0.8892,0.8923,0.8963,0.8999,0.9034,0.9067,0.91,0.9134,0.9166,0.9197,0.9229,0.9252,0.9281,0.9311,0.9334,0.9359,0.9384,0.9411,0.943,0.9452,0.9471,0.9494,0.9515,0.9533,0.955,0.9567,0.9582,0.9599,0.9612,0.9627,0.9639,0.965,0.9662,0.9674,0.9684,0.9696,0.9703,0.971,0.9718,0.9724,0.973,0.9735,0.9747,0.9747,0.9748,0.9751,0.9754,0.9755,0.9758,0.9758,0.9758,0.9757,0.9756,0.9755,0.9753,0.9751,0.9748,0.9745,0.9742,0.9738,0.9734,0.973,0.9725,0.972,0.9715,0.9709,0.9703,0.9697,0.969,0.9683,0.9677,0.9671,0.9663,0.9657,0.9651,0.9643,0.9634,0.9627,0.9621,0.9615,0.9607,0.96,0.9593,0.9586,0.9578,0.9574,0.9568,0.9561,0.9556,0.9551,0.9547,0.9541,0.9535,0.953,0.9525,0.9521,0.9518,0.9515,0.9516,0.951,0.9505,0.9501,0.9498,0.9496,0.9495,0.9495,0.9494,0.9492,0.9491,0.9491,0.9493,0.9494,0.9493,0.9493,0.9495,0.9495,0.9496,0.9499,0.9503,0.9504,0.9507,0.9509,0.9515,0.9517,0.952,0.9524,0.9531,0.9535,0.9539,0.9544,0.955,0.9556,0.9561,0.957,0.9574,0.9579,0.9586,0.9593,0.9601,0.9609,0.9618,0.9623,0.9632,0.9642,0.9647,0.9655,0.9664,0.9673,0.9683,0.9692,0.9699,0.9708,0.9717,0.9727,0.9736,0.9745,0.9758,0.9764,0.9773,0.9786,0.9793,0.9802,0.9813,0.9825,0.9832,0.9842,0.985,0.986,0.987,0.988,0.989,0.9898,0.9908,0.9917,0.9927,0.9937,0.9947,0.9957,0.9964,0.9975,0.9983,0.9991,1.0001,1.001,1.0019,1.0028,1.0038,1.0043,1.0054,1.0061,1.007,1.008,1.0085,1.0094,1.0101,1.0109,1.0117,1.0124,1.0132,1.0139,1.0146,1.0153,1.0162,1.0167,1.0173,1.018,1.0187,1.0192,1.0198,1.0207,1.0212,1.0217,1.0221,1.0228,1.0232,1.0237,1.0243,1.0248,1.0255,1.0259,1.0263,1.0268,1.0273,1.0283,1.0298,1.0304,1.031,1.0318,1.0319,1.0324,1.0326,1.0329,1.0334,1.0335,1.0339,1.0342,1.0346,1.0349,1.0352,1.0357,1.036,1.0362,1.0365,1.0368,1.0372,1.0375,1.0378,1.0381,1.0386,1.0387,1.0389,1.0391,1.0392,1.0393,1.0396,1.0396,1.0396,1.0397,1.0397,1.0397,1.0397,1.0397,1.0396,1.0395,1.0395,1.0394,1.0393,1.0392,1.0391,1.039,1.0389,1.0389,1.0389,1.0387,1.0386,1.0385,1.0383,1.0382,1.0383,1.0383,1.0379,1.0377,1.0376,1.0373,1.0372,1.0369,1.0368,1.0368,1.0367,1.0367,1.0368,1.0368,1.0366,1.0365,1.0365,1.0365,1.0365,1.0365,1.0364,1.0364,1.0365,1.0365,1.0365,1.0365,1.0366,1.0366,1.0367,1.0367,1.0369,1.0368,1.0369,1.0368,1.0369,1.037,1.037,1.0371,1.0372,1.0373,1.0374,1.0376,1.0376,1.0376,1.0377,1.0379,1.038,1.038,1.0381,1.0382,1.0383,1.0384,1.0385,1.0386,1.0387,1.039,1.039,1.039,1.0391,1.0392,1.0398,1.0399,1.0398,1.0397,1.0397,1.04,1.04,1.04,1.0401,1.0402,1.0404]
# z = [0.8402,0.8398,0.8398,0.8399,0.8399,0.8403,0.8408,0.841,0.841,0.8412,0.8421,0.8434,0.844,0.8443,0.8446,0.845,0.8452,0.8456,0.8458,0.846,0.8461,0.8461,0.8464,0.8469,0.8472,0.8476,0.8479,0.8482,0.8483,0.8485,0.8489,0.8493,0.8497,0.8501,0.8505,0.8509,0.8512,0.8515,0.8517,0.8519,0.8518,0.8521,0.8527,0.8529,0.8532,0.8533,0.8533,0.8536,0.8539,0.854,0.8541,0.854,0.8543,0.8544,0.8546,0.8547,0.8548,0.8549,0.8545,0.8547,0.8549,0.855,0.8551,0.8552,0.8555,0.8556,0.8551,0.8543,0.8541,0.8536,0.8537,0.8538,0.8542,0.8551,0.8555,0.8556,0.8562,0.8565,0.8567,0.8566,0.8567,0.8568,0.8568,0.8567,0.8566,0.8567,0.8566,0.8567,0.8557,0.8558,0.8559,0.8557,0.8562,0.8546,0.8542,0.8542,0.8542,0.8541,0.8539,0.8532,0.8532,0.8533,0.8536,0.8537,0.8538,0.8538,0.8541,0.8545,0.8549,0.8554,0.8558,0.8563,0.8566,0.8572,0.8579,0.8585,0.8589,0.8595,0.8602,0.8607,0.8612,0.8617,0.8624,0.863,0.8634,0.864,0.8647,0.8653,0.866,0.8665,0.8669,0.8674,0.8678,0.8685,0.869,0.8697,0.8703,0.8708,0.8713,0.8717,0.8722,0.8743,0.8757,0.8771,0.8776,0.8782,0.8786,0.8789,0.8793,0.8821,0.8836,0.8841,0.8841,0.8844,0.8851,0.8854,0.886,0.8866,0.8866,0.8861,0.8865,0.8868,0.8871,0.8872,0.8875,0.8879,0.8885,0.8888,0.8898,0.8905,0.8916,0.8924,0.8933,0.8941,0.8951,0.8961,0.8964,0.8971,0.8981,0.899,0.8998,0.9001,0.9005,0.9012,0.9018,0.9024,0.903,0.9035,0.904,0.9045,0.9046,0.9047,0.9049,0.9051,0.9055,0.9051,0.905,0.905,0.905,0.9049,0.9052,0.9051,0.9045,0.9042,0.9034,0.9026,0.9021,0.9012,0.9006,0.8999,0.8987,0.8976,0.8971,0.8961,0.8951,0.8942,0.8931,0.8919,0.8907,0.8892,0.8877,0.8863,0.8851,0.8837,0.8825,0.881,0.8796,0.8784,0.8769,0.8754,0.8741,0.8728,0.8715,0.8699,0.8685,0.8669,0.8654,0.8638,0.8624,0.8617,0.8604,0.8593,0.8581,0.8572,0.8558,0.8547,0.8537,0.8522,0.8509,0.85,0.849,0.8471,0.8461,0.845,0.8439,0.8431,0.8419,0.8406,0.8393,0.8384,0.8375,0.8365,0.8354,0.8342,0.8333,0.8323,0.8316,0.8303,0.8291,0.828,0.8269,0.8257,0.8252,0.8242,0.8231,0.8222,0.8212,0.82,0.8192,0.8186,0.8179,0.8173,0.8163,0.8153,0.8147,0.8139,0.8131,0.8125,0.8118,0.8113,0.8106,0.8101,0.8094,0.8091,0.8086,0.8084,0.808,0.8076,0.8075,0.8068,0.8066,0.8067,0.8066,0.8067,0.8068,0.8068,0.807,0.8067,0.8072,0.8076,0.808,0.8084,0.8088,0.8094,0.8099,0.8106,0.8115,0.8125,0.8135,0.8145,0.8154,0.8167,0.8184,0.8197,0.8212,0.8227,0.8243,0.826,0.8279,0.8299,0.8326,0.8356,0.8377,0.8401,0.8425,0.8447,0.8471,0.8493,0.8522,0.8545,0.8571,0.8596,0.8627,0.8655,0.8685,0.8714,0.8745,0.8773,0.8808,0.8836,0.8876,0.8908,0.8941,0.8976,0.9011,0.9046,0.9087,0.9125,0.9159,0.9202,0.9241,0.9284,0.932,0.9358,0.9407,0.9446,0.9493,0.9539,0.9581,0.9624,0.9673,0.9722,0.9765,0.9814,0.9862,0.9909,0.9957,1.0009,1.0054,1.0104,1.0152,1.0197,1.0247,1.0292,1.0347,1.0396,1.0438,1.0491,1.0545,1.0596,1.0651,1.0502,1.0513,1.0796,1.0902,1.098,1.1026,1.107,1.1119,1.1162,1.1221,1.1276,1.1326,1.1394,1.1455,1.1514,1.1572,1.163,1.169,1.1748,1.1805,1.1865,1.1911,1.1968,1.2025,1.2071,1.2124,1.2172,1.2224,1.2265,1.2308,1.235,1.2395,1.2436,1.2472,1.2506,1.2541,1.2567,1.2599,1.2626,1.2648,1.2669,1.2689,1.2709,1.2727,1.274,1.2755,1.2765,1.2775,1.2782,1.2788,1.2793,1.2795,1.2795,1.2796,1.2795,1.2792,1.2787,1.2781,1.2774,1.2767,1.2758,1.2748,1.2736,1.2726,1.2712,1.2698,1.2684,1.2671,1.2657,1.2641,1.2626,1.2611,1.2593,1.2578,1.2559,1.2545,1.253,1.2513,1.2497,1.2482,1.2467,1.2452,1.2441,1.2428,1.2414,1.2404,1.2392,1.2381,1.2372,1.2365,1.2356,1.235,1.2344,1.2338,1.2336,1.2333,1.2332,1.2331,1.2331,1.2334,1.2335,1.2338,1.2342,1.2346,1.2351,1.2357,1.2365,1.2372,1.2379,1.2386,1.2395,1.2407,1.2418,1.2429,1.244,1.245,1.2463,1.2472,1.2482,1.2495,1.2509,1.2521,1.2533,1.2547,1.2558,1.2569,1.2584,1.2596,1.2608,1.2617,1.2629,1.2638,1.265,1.2659,1.2668,1.2677,1.2687,1.2693,1.27,1.2707,1.2714,1.272,1.2724,1.2729,1.2733,1.2736,1.274,1.2743,1.2746,1.2748,1.275,1.275,1.2751,1.2751,1.275,1.2749,1.2748,1.2747,1.2745,1.2742,1.274,1.2737,1.2733,1.273,1.2726,1.2722,1.2716,1.2712,1.2707,1.2702,1.2698,1.2693,1.2688,1.2682,1.2678,1.2671,1.2666,1.2659,1.2654,1.2649,1.2645,1.2641,1.2636,1.2631,1.2627,1.2623,1.2619,1.2616,1.2612,1.2608,1.2605,1.2603,1.26,1.2597,1.2595,1.2593,1.259,1.2589,1.2588,1.2587,1.2587,1.2585,1.2585,1.2586,1.2586,1.2586,1.2588,1.2588,1.2589,1.259,1.2591,1.2593,1.2594,1.2595,1.2597,1.2599,1.2601,1.2602,1.2604,1.2606,1.2608,1.2609,1.261,1.2612,1.2614,1.2615,1.2616,1.2617,1.262,1.2621,1.2622,1.2623,1.2624,1.2623,1.2626,1.2628,1.2629,1.2629,1.2629,1.2629,1.2628,1.2629,1.2628,1.2629,1.2628,1.2627,1.2627,1.2627,1.2627,1.2627,1.2628,1.2628,1.2628,1.2628,1.2629,1.263,1.2631,1.2633,1.2634,1.2636,1.2637,1.2639,1.2641,1.2642,1.2643,1.2646,1.2647,1.265,1.2654,1.2658,1.266,1.2662,1.2664,1.2665,1.2666,1.2667,1.2666,1.2665,1.2664,1.2662,1.2659,1.2655,1.2652,1.2649,1.2643,1.2637,1.263,1.261,1.2585,1.2567,1.2525,1.2492,1.2473,1.2458,1.2445,1.2426,1.2409,1.2389,1.2368,1.2349,1.2325,1.2305,1.2285,1.2258,1.2234,1.2211,1.2183,1.216,1.2131,1.2103,1.2073,1.2046,1.2014,1.1982,1.1949,1.192,1.1883,1.1848,1.1812,1.1782,1.174,1.17,1.1661,1.1622,1.158,1.1538,1.1497,1.1451,1.1406,1.1359,1.1321,1.127,1.1221,1.1171,1.1121,1.1077,1.1021,1.0967,1.0914,1.0862,1.0805,1.0748,1.0694,1.0636,1.0587,1.0521,1.0458,1.0399,1.0334,1.0287,1.0227,1.016,1.0076,1.0007,0.995,0.9877,0.9804,0.9733,0.9657]

# Maze 2 .bag xyz
# x = [-1.1892,-1.1892,-1.1892,-1.1892,-1.1892,-1.1892,-1.189,-1.1889,-1.189,-1.1891,-1.1891,-1.1891,-1.1891,-1.1891,-1.1891,-1.189,-1.189,-1.1891,-1.189,-1.189,-1.189,-1.189,-1.189,-1.189,-1.189,-1.1891,-1.1891,-1.1892,-1.1892,-1.1892,-1.1893,-1.1894,-1.1894,-1.1895,-1.1896,-1.1897,-1.1897,-1.1898,-1.1898,-1.1899,-1.19,-1.1901,-1.1905,-1.1908,-1.191,-1.191,-1.1909,-1.1909,-1.191,-1.1911,-1.1912,-1.1913,-1.1914,-1.1915,-1.1916,-1.1917,-1.1918,-1.1919,-1.1919,-1.192,-1.192,-1.192,-1.192,-1.1921,-1.1921,-1.1922,-1.1921,-1.1921,-1.1922,-1.1921,-1.1922,-1.1921,-1.1922,-1.1921,-1.192,-1.192,-1.192,-1.1919,-1.1919,-1.1918,-1.1917,-1.1917,-1.1917,-1.1916,-1.1915,-1.1915,-1.1913,-1.1913,-1.1913,-1.1912,-1.191,-1.191,-1.191,-1.1909,-1.1908,-1.1908,-1.1907,-1.1907,-1.1907,-1.1907,-1.1907,-1.1906,-1.1904,-1.1905,-1.1905,-1.1905,-1.1905,-1.1905,-1.1906,-1.1905,-1.1906,-1.1904,-1.1904,-1.1904,-1.1904,-1.1904,-1.1904,-1.1904,-1.1904,-1.1905,-1.1905,-1.1905,-1.1905,-1.1904,-1.1903,-1.1902,-1.1902,-1.1901,-1.1899,-1.1898,-1.1896,-1.1894,-1.1891,-1.1888,-1.1885,-1.1881,-1.1875,-1.1868,-1.1862,-1.1855,-1.1847,-1.1837,-1.1824,-1.1814,-1.1799,-1.1786,-1.1769,-1.1754,-1.1735,-1.1717,-1.1699,-1.1677,-1.1652,-1.1625,-1.1605,-1.1582,-1.1545,-1.1514,-1.1477,-1.1447,-1.141,-1.1371,-1.1332,-1.1291,-1.1248,-1.1208,-1.1161,-1.1109,-1.1065,-1.1018,-1.096,-1.0905,-1.0851,-1.0792,-1.0732,-1.0672,-1.0615,-1.0548,-1.0484,-1.0409,-1.0339,-1.027,-1.0202,-1.0127,-1.0041,-0.9966,-0.99,-0.9807,-0.9717,-0.9647,-0.9552,-0.9464,-0.9369,-0.929,-0.9202,-0.9095,-0.9006,-0.8913,-0.8824,-0.8729,-0.8622,-0.8514,-0.8437,-0.822,-0.8066,-0.7903,-0.7763,-0.7665,-0.7577,-0.7463,-0.7348,-0.7231,-0.7139,-0.7009,-0.6905,-0.6798,-0.6683,-0.656,-0.6473,-0.6346,-0.6246,-0.612,-0.6017,-0.5919,-0.5795,-0.5677,-0.5561,-0.5462,-0.5342,-0.5222,-0.5132,-0.5,-0.4904,-0.4781,-0.4667,-0.4552,-0.4436,-0.4339,-0.4211,-0.4116,-0.399,-0.3867,-0.3773,-0.3642,-0.3536,-0.3415,-0.3292,-0.3183,-0.3071,-0.2945,-0.2844,-0.271,-0.2591,-0.2478,-0.236,-0.2255,-0.2113,-0.2013,-0.1884,-0.1763,-0.1644,-0.1553,-0.1421,-0.1279,-0.1184,-0.1053,-0.093,-0.0811,-0.0689,-0.0576,-0.0465,-0.0339,-0.0213,-0.0106,0.0022,0.0126,0.0259,0.036,0.0481,0.0599,0.072,0.0828,0.095,0.1045,0.1172,0.1292,0.1403,0.1522,0.1619,0.1742,0.1851,0.1964,0.2067,0.2174,0.23,0.2407,0.2504,0.2621,0.2732,0.2839,0.2951,0.3045,0.3147,0.326,0.337,0.3461,0.3575,0.368,0.4036,0.4242,0.4394,0.449,0.4565,0.4665,0.4768,0.4846,0.4953,0.5041,0.5142,0.5239,0.5332,0.5412,0.5512,0.5595,0.5678,0.5774,0.5858,0.5932,0.6026,0.6105,0.6183,0.6268,0.6356,0.6423,0.6511,0.6591,0.6665,0.6744,0.6823,0.69,0.697,0.7059,0.7121,0.7203,0.7282,0.7358,0.7432,0.7516,0.7732,0.7877,0.7981,0.8059,0.8131,0.8186,0.8255,0.8322,0.8402,0.8476,0.855,0.8626,0.8685,0.8768,0.8827,0.8901,0.8969,0.9037,0.9093,0.9159,0.9217,0.9282,0.9346,0.9406,0.9465,0.9527,0.9587,0.9644,0.9702,0.9769,0.9831,0.9895,0.9943,1.0013,1.0067,1.0135,1.0187,1.0254,1.049,1.06,1.0718,1.081,1.0879,1.0972,1.1042,1.1102,1.1177,1.1252,1.1327,1.1385,1.1462,1.1546,1.1606,1.1684,1.1762,1.1841,1.1912,1.1984,1.2041,1.2124,1.2208,1.2266,1.2352,1.242,1.2481,1.2564,1.2641,1.2714,1.2787,1.2864,1.2931,1.3011,1.3089,1.317,1.3235,1.3322,1.3386,1.3466,1.3547,1.3609,1.3691,1.3773,1.3855,1.3911,1.4,1.417,1.4311,1.4407,1.4485,1.456,1.4618,1.4701,1.478,1.4866,1.4928,1.5008,1.5092,1.5155,1.5238,1.5305,1.5381,1.5463,1.5532,1.5597,1.5677,1.5754,1.5827,1.5909,1.5978,1.6049,1.6134,1.6198,1.628,1.6355,1.6428,1.6508,1.6589,1.6658,1.6732,1.6818,1.6889,1.6971,1.7051,1.7131,1.7213,1.7289,1.737,1.7445,1.7521,1.7611,1.7692,1.7759,1.7846,1.7931,1.8015,1.8082,1.8147,1.8245,1.8328,1.8401,1.8487,1.8557,1.8637,1.8722,1.8784,1.8873,1.8936,1.9018,1.9095,1.9173,1.9241,1.9314,1.9382,1.9459,1.953,1.9604,1.9671,1.9727,1.9807,1.9864,1.9943,2.0002,2.0069,2.0126,2.0197,2.0252,2.0316,2.0377,2.0437,2.0501,2.0553,2.061,2.0663,2.0722,2.0779,2.0833,2.0888,2.0936,2.0986,2.104,2.1091,2.113,2.1182,2.1232,2.1279,2.1324,2.1368,2.1412,2.153,2.1599,2.1658,2.1701,2.1735,2.177,2.1802,2.1832,2.1867,2.1904,2.1936,2.1967,2.1991,2.2019,2.2049,2.2075,2.21,2.2119,2.214,2.2158,2.2179,2.2197,2.2218,2.2236,2.2252,2.2269,2.2282,2.2295,2.2311,2.2322,2.2335,2.2345,2.2358,2.2366,2.2373,2.2379,2.2385,2.2391,2.2393,2.2395,2.2398,2.24,2.2402,2.2403,2.2404,2.2404,2.2404,2.2402,2.24,2.2397,2.2394,2.239,2.2386,2.2379,2.2376,2.237,2.2364,2.2358,2.235,2.2343,2.2334,2.2326,2.2318,2.2308,2.2298,2.2288,2.2277,2.2268,2.2255,2.2246,2.2237,2.2224,2.2213,2.2202,2.2189,2.2177,2.2166,2.2155,2.2143,2.2131,2.2121,2.2111,2.2101,2.2088,2.2078,2.2066,2.2055,2.2045,2.2036,2.2024,2.2012,2.2004,2.1995,2.1988,2.198,2.1971,2.1965,2.1959,2.195,2.1943,2.1935,2.1926,2.192,2.1915,2.1911,2.1908,2.1904,2.1901,2.1898,2.1895,2.1892,2.1889,2.1888,2.1886,2.1884,2.1883,2.1883,2.1882,2.1882,2.1883,2.1883,2.1887,2.1888,2.1888,2.1889,2.189,2.1891,2.1893,2.1894,2.1896,2.1899,2.1902,2.1905,2.1908,2.1911,2.1914,2.1918,2.1923,2.1926,2.193,2.1934,2.1937,2.194,2.1944,2.1947,2.1954,2.1964,2.197,2.1976,2.198,2.1985,2.1991,2.1995,2.2,2.2003,2.2007,2.201,2.2014,2.2019,2.2022,2.2025,2.2029,2.2032,2.2034,2.2036,2.2037,2.2038,2.2039,2.204,2.2041,2.2042,2.2043,2.2042,2.2041,2.204,2.204,2.204,2.2039,2.2037,2.2035,2.2033,2.2032,2.203,2.2025,2.2022,2.2016,2.2014,2.2011,2.2008,2.2004,2.1999,2.1996,2.1992,2.1987,2.1985,2.1982,2.1974,2.1969,2.1964,2.1959,2.1955,2.1949,2.1943,2.1937,2.1933,2.1927,2.1921,2.1916,2.1911,2.1906,2.1901,2.1897,2.1893,2.1887,2.1881,2.1876,2.1872,2.1867,2.1862,2.1857,2.1852,2.1846,2.1843,2.184,2.1836,2.1832,2.1828,2.1824,2.1821,2.1818,2.1815,2.1812,2.1809,2.1804,2.18,2.1799,2.1797,2.1794,2.1793,2.1791,2.1788,2.1787,2.1783,2.1778,2.1779,2.1778,2.1773,2.1772,2.1771,2.1768,2.1767,2.1767,2.1765,2.1765,2.1764,2.1762,2.1762,2.1761,2.1759,2.1758,2.1756,2.1754,2.175,2.1748,2.1747,2.1747,2.1746,2.1745,2.1734,2.173,2.1732,2.1739,2.174,2.1745]
# y = [1.0472,1.0473,1.0472,1.0472,1.0473,1.0474,1.0477,1.0478,1.0479,1.0479,1.048,1.0481,1.0482,1.0484,1.0485,1.0486,1.0488,1.049,1.0492,1.0494,1.0496,1.0497,1.0498,1.05,1.0501,1.0503,1.0504,1.0505,1.0506,1.0507,1.0508,1.0509,1.051,1.0511,1.0511,1.0512,1.0512,1.0513,1.0514,1.0514,1.0514,1.0515,1.0512,1.0511,1.051,1.0509,1.051,1.0508,1.0506,1.0505,1.0503,1.0502,1.0501,1.05,1.0498,1.0497,1.0495,1.0493,1.0492,1.049,1.049,1.0488,1.0487,1.0485,1.0483,1.048,1.0479,1.0476,1.0473,1.047,1.0468,1.0466,1.0463,1.0461,1.0459,1.0457,1.0454,1.0453,1.0451,1.0449,1.0447,1.0445,1.0442,1.044,1.0439,1.0437,1.0437,1.0436,1.0435,1.0434,1.0433,1.0432,1.043,1.0429,1.043,1.0428,1.0429,1.0427,1.0425,1.0424,1.0423,1.0423,1.043,1.0428,1.0425,1.0424,1.0424,1.0424,1.0423,1.0423,1.0423,1.0424,1.0423,1.0422,1.0422,1.0422,1.0421,1.0422,1.0421,1.042,1.042,1.0419,1.0419,1.0418,1.0416,1.0414,1.0412,1.041,1.0409,1.0407,1.0402,1.0399,1.0397,1.0394,1.039,1.0388,1.0383,1.038,1.0376,1.0372,1.0367,1.0362,1.0357,1.0352,1.0346,1.034,1.0333,1.0328,1.0322,1.0317,1.031,1.0302,1.0296,1.029,1.0287,1.028,1.027,1.0262,1.0252,1.0244,1.0236,1.0228,1.022,1.0212,1.0202,1.0194,1.0186,1.0178,1.0169,1.0161,1.0152,1.0145,1.0137,1.0129,1.0121,1.0112,1.0103,1.0095,1.0089,1.008,1.0075,1.0067,1.0057,1.005,1.0043,1.0037,1.003,1.0022,1.0016,1.001,1.0004,0.9998,0.9994,0.9988,0.9983,0.9977,0.9974,0.997,0.9965,0.9961,0.9956,0.9953,0.9959,0.9951,0.9946,0.9941,0.9933,0.9933,0.9929,0.9927,0.9926,0.9926,0.9924,0.9925,0.9923,0.9923,0.9922,0.9925,0.9923,0.9923,0.9924,0.9924,0.9928,0.9928,0.993,0.993,0.9932,0.9934,0.9938,0.9943,0.9946,0.9951,0.9954,0.9959,0.9963,0.9968,0.9975,0.998,0.9988,0.9992,0.9998,1.0008,1.0012,1.0019,1.0024,1.0032,1.0044,1.0053,1.0058,1.0068,1.0074,1.0083,1.0096,1.0106,1.0115,1.0123,1.0137,1.0145,1.0156,1.0169,1.0181,1.0189,1.0201,1.0217,1.0226,1.0239,1.0253,1.0266,1.028,1.0292,1.0307,1.0322,1.0337,1.0351,1.0367,1.0379,1.0397,1.0409,1.0424,1.0438,1.0454,1.0469,1.0486,1.0498,1.0515,1.0531,1.0547,1.0563,1.0576,1.0593,1.0608,1.0624,1.0637,1.0652,1.0668,1.0681,1.0695,1.0711,1.0725,1.0738,1.0755,1.0767,1.0779,1.0793,1.0807,1.0818,1.0832,1.0852,1.0884,1.0901,1.0913,1.0919,1.0925,1.0931,1.0938,1.0942,1.0947,1.0951,1.0955,1.0957,1.0958,1.096,1.0958,1.0956,1.0954,1.095,1.0946,1.094,1.0931,1.0923,1.0914,1.0904,1.0893,1.0883,1.0867,1.0852,1.0835,1.0819,1.08,1.078,1.0761,1.0736,1.0716,1.0688,1.066,1.0633,1.0604,1.0585,1.0385,1.0285,1.022,1.0042,0.9948,1.015,1.0198,1.0165,1.0105,1.0046,0.9989,0.9935,0.9891,0.9829,0.9785,0.973,0.9678,0.9627,0.9587,0.9538,0.95,0.9454,0.9409,0.9368,0.9329,0.9292,0.9257,0.922,0.918,0.9133,0.9088,0.9045,0.9003,0.8949,0.8899,0.8841,0.8795,0.8737,0.8522,0.8427,0.8319,0.8226,0.8156,0.8051,0.7976,0.7915,0.7834,0.7754,0.7676,0.7614,0.7531,0.7448,0.7382,0.7295,0.7212,0.7133,0.7058,0.6978,0.6917,0.683,0.6744,0.668,0.6595,0.6526,0.6462,0.6377,0.6303,0.623,0.616,0.6094,0.6031,0.5958,0.5892,0.5827,0.577,0.5707,0.5654,0.5591,0.5532,0.5486,0.5429,0.5376,0.5328,0.5298,0.5242,0.5171,0.5106,0.5067,0.5017,0.4988,0.4967,0.4941,0.4918,0.4898,0.4884,0.4866,0.4852,0.4843,0.4835,0.4833,0.4832,0.4836,0.4841,0.4846,0.4856,0.4868,0.4883,0.4903,0.4921,0.4942,0.497,0.4994,0.5026,0.5059,0.5092,0.5131,0.5173,0.5211,0.5252,0.5303,0.5346,0.5398,0.5451,0.5507,0.5566,0.5623,0.5685,0.5744,0.5805,0.5879,0.5947,0.6003,0.6078,0.6153,0.6227,0.6293,0.6355,0.6449,0.653,0.6601,0.6692,0.6764,0.6847,0.6938,0.7005,0.7104,0.7174,0.7266,0.7354,0.7446,0.7528,0.7613,0.7693,0.7787,0.7872,0.7967,0.8052,0.8123,0.8227,0.8301,0.8404,0.8483,0.8572,0.8651,0.8749,0.8824,0.8914,0.8998,0.9083,0.9173,0.9249,0.9331,0.9408,0.9495,0.9577,0.9657,0.974,0.9812,0.9886,0.9966,1.0044,1.0106,1.0185,1.0259,1.0331,1.0399,1.0466,1.0547,1.0735,1.0845,1.0939,1.0996,1.1047,1.1103,1.1155,1.1203,1.126,1.1316,1.1367,1.1417,1.1456,1.1501,1.1547,1.1587,1.1625,1.1654,1.1689,1.1716,1.1747,1.1774,1.1802,1.1827,1.1851,1.1876,1.1895,1.1913,1.1935,1.1949,1.1966,1.1979,1.199,1.2,1.2007,1.2014,1.202,1.2025,1.2029,1.2032,1.2034,1.2034,1.2034,1.2032,1.2028,1.2024,1.2018,1.2012,1.2003,1.1994,1.1986,1.1975,1.1964,1.1951,1.1941,1.1926,1.1913,1.1896,1.1879,1.1863,1.1845,1.1828,1.1811,1.1791,1.1771,1.1751,1.1729,1.1711,1.1687,1.1666,1.1649,1.1623,1.1602,1.1579,1.1556,1.1534,1.1512,1.149,1.1467,1.1445,1.1422,1.1401,1.1381,1.1357,1.1338,1.1317,1.1296,1.1275,1.1257,1.1238,1.1219,1.1203,1.1183,1.1166,1.1151,1.1133,1.112,1.1103,1.1093,1.1072,1.1052,1.1038,1.1025,1.1014,1.1004,1.0994,1.0985,1.0977,1.0968,1.0961,1.0954,1.0946,1.094,1.0935,1.093,1.0925,1.092,1.0916,1.0913,1.0909,1.0906,1.0904,1.0902,1.09,1.0899,1.0898,1.0897,1.0897,1.0897,1.0897,1.0898,1.0899,1.09,1.0901,1.0903,1.0904,1.0907,1.091,1.0912,1.0915,1.0918,1.0922,1.0925,1.0929,1.0938,1.0939,1.0942,1.0946,1.095,1.0954,1.0959,1.0964,1.0967,1.0972,1.0976,1.098,1.0984,1.0988,1.0992,1.0996,1.0999,1.1003,1.1006,1.1009,1.1012,1.1015,1.1017,1.1019,1.1021,1.1023,1.1025,1.1026,1.1028,1.103,1.103,1.1031,1.1031,1.1031,1.1032,1.1032,1.1032,1.1031,1.1031,1.1029,1.1029,1.1034,1.1029,1.1026,1.1023,1.1022,1.102,1.1019,1.1017,1.1015,1.1013,1.1011,1.1008,1.1005,1.1002,1.0999,1.0996,1.0993,1.099,1.0986,1.0984,1.098,1.0977,1.0974,1.097,1.0967,1.0964,1.096,1.0957,1.0954,1.0951,1.0948,1.0944,1.0941,1.0938,1.0935,1.0932,1.0929,1.0926,1.0924,1.0921,1.0918,1.0915,1.0912,1.091,1.0908,1.0906,1.0903,1.0901,1.0899,1.0897,1.0895,1.0893,1.0892,1.089,1.0888,1.0886,1.0885,1.0882,1.0886,1.088,1.0877,1.0873,1.0871,1.0868,1.0867,1.0866,1.0864,1.0862,1.0861,1.0859,1.0858,1.0859,1.0858,1.0857,1.0856,1.0855,1.0854,1.0851,1.0851,1.085,1.085,1.0852,1.0852,1.0831,1.0821,1.0817,1.0821,1.0823,1.0828]
# z = [0.8478,0.8477,0.8471,0.847,0.8468,0.8467,0.8464,0.8463,0.8464,0.8465,0.8463,0.846,0.8461,0.8461,0.846,0.8458,0.8457,0.8459,0.8459,0.8457,0.8455,0.8454,0.8453,0.8452,0.8452,0.845,0.8451,0.8449,0.8449,0.8447,0.8446,0.8445,0.8445,0.8444,0.8443,0.8444,0.8442,0.8442,0.8441,0.8442,0.8442,0.8441,0.8437,0.8437,0.8436,0.8435,0.8438,0.8435,0.8437,0.8438,0.8439,0.8439,0.8439,0.8442,0.8445,0.8447,0.8448,0.8448,0.8451,0.8453,0.8457,0.8458,0.846,0.8461,0.8463,0.8464,0.8465,0.8466,0.8465,0.8461,0.8463,0.8464,0.8467,0.8468,0.8468,0.8469,0.8471,0.8472,0.8474,0.8476,0.8477,0.848,0.8482,0.8485,0.8486,0.8487,0.8492,0.8497,0.85,0.8502,0.8502,0.8504,0.8507,0.851,0.8511,0.8513,0.8513,0.8515,0.8513,0.8514,0.8515,0.8516,0.8524,0.8523,0.8524,0.8525,0.8527,0.8529,0.8529,0.853,0.8531,0.853,0.8531,0.8532,0.8534,0.8534,0.8535,0.8535,0.8536,0.8539,0.8539,0.8541,0.8541,0.8541,0.8541,0.8541,0.8541,0.8542,0.8544,0.8545,0.8542,0.8542,0.854,0.8541,0.8542,0.8541,0.8539,0.8543,0.8546,0.8549,0.8551,0.8552,0.855,0.8551,0.8545,0.8551,0.8556,0.8558,0.8556,0.856,0.8561,0.8562,0.8563,0.8564,0.8574,0.8576,0.858,0.8581,0.8579,0.8582,0.8587,0.8592,0.8596,0.86,0.8601,0.8604,0.8608,0.8609,0.8614,0.8618,0.8622,0.8629,0.8632,0.8636,0.8639,0.8637,0.8641,0.8645,0.865,0.8653,0.8654,0.8655,0.8658,0.8661,0.8663,0.8663,0.8667,0.8671,0.8671,0.8675,0.8679,0.8682,0.8683,0.8686,0.8688,0.8687,0.869,0.8691,0.8697,0.8699,0.87,0.8697,0.8701,0.8704,0.8706,0.8707,0.8707,0.8707,0.8707,0.8707,0.8708,0.8709,0.8711,0.8713,0.8715,0.8717,0.8717,0.8719,0.8719,0.872,0.872,0.872,0.8725,0.8729,0.8735,0.8737,0.8743,0.8749,0.8756,0.8763,0.877,0.8778,0.8784,0.8793,0.88,0.8807,0.8816,0.8823,0.8833,0.884,0.8849,0.8858,0.8866,0.8876,0.8885,0.8894,0.8907,0.8916,0.8922,0.893,0.8935,0.8944,0.895,0.896,0.8969,0.8979,0.8986,0.8995,0.9005,0.901,0.9021,0.9025,0.9033,0.904,0.9047,0.9056,0.9064,0.9072,0.908,0.9089,0.9094,0.9101,0.9106,0.911,0.9116,0.9121,0.9125,0.9132,0.9137,0.9144,0.9145,0.915,0.9155,0.9158,0.9163,0.9165,0.9168,0.9171,0.9173,0.9176,0.9177,0.9179,0.918,0.9182,0.9178,0.9182,0.9184,0.9187,0.9187,0.9187,0.9184,0.9184,0.9185,0.9187,0.9189,0.9191,0.9188,0.9191,0.9185,0.9181,0.9177,0.9173,0.917,0.9161,0.9157,0.916,0.916,0.9158,0.9153,0.9153,0.9149,0.9147,0.9146,0.9141,0.9136,0.9134,0.9132,0.9129,0.9125,0.9119,0.9115,0.9111,0.911,0.9109,0.9105,0.9099,0.9096,0.9095,0.9092,0.9086,0.9081,0.9071,0.9066,0.9058,0.9053,0.9046,0.9042,0.9055,0.889,0.8833,0.8805,0.8595,0.8514,0.8838,0.8959,0.8968,0.8953,0.8933,0.8922,0.8909,0.8901,0.8888,0.888,0.8864,0.8851,0.8836,0.882,0.8801,0.8781,0.8754,0.8722,0.87,0.8679,0.8658,0.864,0.8621,0.8602,0.8581,0.8562,0.8542,0.8526,0.8502,0.8488,0.8464,0.8449,0.8436,0.8384,0.8362,0.8338,0.8324,0.8313,0.8301,0.8292,0.8286,0.8279,0.8271,0.8269,0.8265,0.8259,0.8256,0.8255,0.8252,0.8248,0.8247,0.8245,0.8247,0.8245,0.8245,0.8246,0.8246,0.8247,0.8249,0.8249,0.8249,0.825,0.8248,0.8249,0.825,0.8251,0.8253,0.8256,0.8256,0.8255,0.8256,0.8255,0.8252,0.8251,0.8251,0.8249,0.8246,0.8248,0.8246,0.8245,0.8237,0.8235,0.8233,0.823,0.8228,0.8226,0.8223,0.8219,0.8217,0.8216,0.8213,0.8207,0.8204,0.82,0.8201,0.82,0.8202,0.8203,0.8204,0.8205,0.8207,0.8211,0.8217,0.8223,0.823,0.8236,0.8243,0.825,0.8259,0.8271,0.8281,0.8292,0.8302,0.8314,0.8328,0.8342,0.8359,0.8375,0.8391,0.841,0.8428,0.8447,0.8465,0.8484,0.8509,0.8531,0.8552,0.8577,0.8604,0.8629,0.8651,0.8672,0.8705,0.8734,0.8759,0.879,0.8815,0.8845,0.8877,0.8903,0.8938,0.8964,0.9,0.9032,0.9069,0.9101,0.9139,0.9172,0.921,0.9248,0.9288,0.9326,0.9357,0.9404,0.9438,0.9489,0.9528,0.9572,0.9608,0.9657,0.9697,0.9744,0.979,0.9837,0.9889,0.9932,0.998,1.0024,1.0076,1.0128,1.0176,1.023,1.0277,1.0326,1.0381,1.0431,1.0471,1.0527,1.0582,1.0634,1.0685,1.0736,1.0797,1.0948,1.1036,1.1115,1.1164,1.1209,1.1258,1.1304,1.1349,1.1401,1.1457,1.1506,1.1556,1.1595,1.1641,1.1689,1.1732,1.1776,1.181,1.1849,1.1882,1.1924,1.1962,1.2007,1.2048,1.2086,1.2127,1.2162,1.2196,1.2241,1.2271,1.231,1.2342,1.2379,1.2411,1.2436,1.2467,1.2495,1.2524,1.2548,1.257,1.2595,1.2618,1.2642,1.2663,1.2684,1.2702,1.2719,1.2735,1.2751,1.2764,1.2775,1.2786,1.2796,1.2804,1.281,1.2818,1.2822,1.2826,1.2828,1.2828,1.2826,1.2824,1.282,1.2814,1.2808,1.28,1.279,1.2782,1.2769,1.2759,1.275,1.2734,1.272,1.2705,1.2687,1.2672,1.2656,1.2639,1.2622,1.2604,1.2588,1.2572,1.2556,1.2537,1.2522,1.2504,1.2487,1.2472,1.2459,1.2442,1.2427,1.2417,1.2405,1.2397,1.2388,1.2379,1.2374,1.2369,1.2369,1.2361,1.2355,1.235,1.2348,1.235,1.2352,1.2354,1.2357,1.2361,1.2367,1.2372,1.2376,1.2383,1.239,1.2397,1.2406,1.2414,1.2422,1.2431,1.2441,1.2449,1.2458,1.2472,1.2481,1.2489,1.2501,1.2509,1.2517,1.2526,1.2535,1.2543,1.2552,1.2561,1.2569,1.2578,1.2585,1.2591,1.2598,1.2608,1.2613,1.2619,1.2625,1.2628,1.2631,1.2636,1.2645,1.2646,1.2653,1.2657,1.266,1.266,1.2661,1.2661,1.2661,1.2659,1.2655,1.265,1.2648,1.2642,1.2638,1.2633,1.2625,1.2616,1.2608,1.2599,1.259,1.2575,1.2564,1.2553,1.2537,1.2526,1.2511,1.2498,1.2481,1.2464,1.2448,1.2435,1.2417,1.2397,1.2381,1.2361,1.2339,1.2322,1.2298,1.2275,1.225,1.2233,1.2207,1.2179,1.2147,1.212,1.2094,1.2068,1.2042,1.2008,1.1977,1.195,1.191,1.1876,1.1842,1.1803,1.1767,1.173,1.1687,1.1644,1.161,1.1565,1.152,1.1477,1.1432,1.1386,1.1342,1.1293,1.1254,1.1198,1.1154,1.1101,1.1049,1.0997,1.0945,1.0888,1.0843,1.0781,1.0723,1.0676,1.0618,1.0553,1.0501,1.0434,1.0381,1.0316,1.0254,1.0188,1.0132,1.0063,0.9989,0.9931,0.9864,0.9798,0.9723,0.9653,0.958,0.9517,0.9438,0.9361,0.9304,0.922,0.9142,0.9044,0.8971,0.8882,0.8795,0.8705,0.8607,0.8504,0.8395,0.828,0.8156,0.803,0.7905,0.7761,0.7618,0.7449,0.7287,0.7109,0.6938,0.675,0.6548,0.6384,0.6203,0.6188,0.6219,0.6259,0.6274,0.6291]

# Maze 3 .bag xyz
# x = [2.1713,2.1714,2.1711,2.1708,2.1708,2.1705,2.1702,2.1698,2.1697,2.1696,2.169,2.1688,2.1688,2.1687,2.1689,2.1687,2.1686,2.1685,2.1685,2.1685,2.1686,2.1685,2.1683,2.1686,2.1684,2.1681,2.168,2.1678,2.1674,2.1671,2.1669,2.1666,2.1659,2.1653,2.1648,2.1641,2.1634,2.1628,2.1621,2.1611,2.1601,2.159,2.158,2.1567,2.1553,2.1537,2.1523,2.1508,2.1491,2.1473,2.1455,2.143,2.1372,2.1331,2.1295,2.1265,2.1242,2.1217,2.1185,2.1154,2.1121,2.109,2.1056,2.1025,2.0994,2.095,2.0911,2.0878,2.0835,2.0792,2.0756,2.0709,2.0667,2.0618,2.0571,2.0531,2.0477,2.0425,2.0376,2.0329,2.0281,2.0219,2.0162,2.0106,2.0048,2.0001,1.9933,1.9877,1.9813,1.9748,1.9684,1.9628,1.9557,1.9487,1.9418,1.9357,1.9283,1.9208,1.914,1.9079,1.8994,1.8917,1.8839,1.8761,1.8701,1.8618,1.8536,1.8443,1.8371,1.8296,1.8199,1.8123,1.8029,1.7956,1.7863,1.7768,1.7694,1.7594,1.7511,1.742,1.7322,1.7231,1.7136,1.7053,1.6961,1.6856,1.6763,1.6676,1.657,1.647,1.6373,1.6272,1.6184,1.6076,1.5975,1.3421,1.3306,1.3193,1.3088,1.2982,1.2868,1.2737,1.2617,1.2494,1.24,1.2268,1.2145,1.202,1.192,1.179,1.1665,1.1547,1.1423,1.1302,1.1174,1.1075,1.0942,1.0822,1.0712,1.0595,1.0462,1.0344,1.0231,1.0101,0.9691,0.9414,0.9283,0.9152,0.9048,0.8939,0.8828,0.8718,0.8602,0.8485,0.837,0.8249,0.8142,0.8019,0.7892,0.7784,0.7656,0.7527,0.7412,0.7292,0.7181,0.7049,0.6929,0.6814,0.6694,0.6587,0.6478,0.6366,0.6241,0.6138,0.6034,0.5909,0.5808,0.5706,0.5602,0.5499,0.5388,0.5284,0.5186,0.5086,0.4989,0.4891,0.4795,0.4698,0.4602,0.4506,0.443,0.4324,0.4249,0.4149,0.4054,0.3738,0.3584,0.3476,0.3355,0.327,0.3208,0.3127,0.305,0.2977,0.2905,0.2819,0.2739,0.2662,0.2589,0.2511,0.2451,0.2368,0.2296,0.222,0.2147,0.2081,0.2017,0.1938,0.1867,0.1793,0.1733,0.1657,0.1594,0.153,0.1456,0.1387,0.1319,0.1254,0.1185,0.1122,0.1068,0.0994,0.0925,0.0859,0.0795,0.0729,0.0662,0.0608,0.0538,0.0467,0.0407,0.0346,0.0276,0.022,0.0153,0.0089,0.0025,-0.0041,-0.0096,-0.0162,-0.023,-0.0284,-0.0351,-0.0417,-0.0483,-0.0538,-0.0606,-0.0659,-0.0728,-0.0794,-0.086,-0.091,-0.0982,-0.1042,-0.111,-0.1168,-0.1239,-0.1287,-0.1358,-0.1581,-0.1787,-0.1943,-0.2022,-0.2077,-0.2129,-0.2188,-0.2244,-0.2306,-0.238,-0.2448,-0.2517,-0.257,-0.2646,-0.2718,-0.2782,-0.2845,-0.2918,-0.2975,-0.3052,-0.3113,-0.3183,-0.325,-0.3318,-0.3378,-0.3439,-0.3515,-0.3585,-0.3645,-0.3714,-0.3782,-0.3837,-0.3908,-0.3982,-0.4038,-0.4101,-0.4177,-0.424,-0.4302,-0.4369,-0.4448,-0.4511,-0.4564,-0.464,-0.4705,-0.4764,-0.4835,-0.4906,-0.4962,-0.5037,-0.51,-0.5174,-0.5234,-0.5299,-0.5373,-0.5443,-0.5513,-0.5578,-0.5648,-0.5717,-0.5779,-0.584,-0.5924,-0.599,-0.6058,-0.6121,-0.6202,-0.6277,-0.6338,-0.641,-0.6477,-0.6556,-0.6618,-0.6694,-0.6773,-0.6829,-0.6908,-0.6982,-0.7058,-0.7118,-0.7197,-0.7273,-0.7349,-0.7412,-0.7492,-0.7562,-0.7663,-0.7752,-0.7836,-0.794,-0.8016,-0.8086,-0.8148,-0.8224,-0.8301,-0.8365,-0.8447,-0.8525,-0.8593,-0.8677,-0.874,-0.8828,-0.8913,-0.8979,-0.9065,-0.9145,-0.9226,-0.9305,-0.9379,-0.9446,-0.9533,-0.9611,-0.9688,-0.9766,-0.9842,-0.9919,-0.9994,-1.0072,-1.0152,-1.022,-1.0305,-1.0369,-1.0451,-1.0531,-1.0607,-1.0685,-1.0751,-1.083,-1.0907,-1.0982,-1.1057,-1.1131,-1.1205,-1.1282,-1.1354,-1.142,-1.1503,-1.1574,-1.1646,-1.1717,-1.1779,-1.1858,-1.1936,-1.2003,-1.2073,-1.2137,-1.2219,-1.2278,-1.2355,-1.2424,-1.2505,-1.2579,-1.2652,-1.2718,-1.2785,-1.2845,-1.2925,-1.299,-1.3065,-1.3125,-1.3197,-1.3264,-1.3332,-1.3397,-1.3445,-1.3501,-1.3583,-1.3651,-1.3723,-1.3778,-1.385,-1.3897,-1.3955,-1.4029,-1.4087,-1.4148,-1.4209,-1.4265,-1.4318,-1.4382,-1.4443,-1.4493,-1.4555,-1.4611,-1.4656,-1.472,-1.4779,-1.4829,-1.4876,-1.4934,-1.4981,-1.5029,-1.508,-1.5131,-1.5169,-1.5221,-1.5268,-1.5314,-1.5355,-1.5399,-1.5444,-1.5478,-1.5522,-1.5563,-1.5604,-1.5637,-1.5675,-1.5713,-1.5742,-1.5781,-1.5812,-1.5845,-1.5877,-1.5907,-1.5936,-1.5966,-1.599,-1.6015,-1.6043,-1.6069,-1.6094,-1.6114,-1.6138,-1.6156,-1.6178,-1.6198,-1.6214,-1.6234,-1.6256,-1.6279,-1.6295,-1.6309,-1.6322,-1.6331,-1.6343,-1.6352,-1.6362,-1.6371,-1.6378,-1.6386,-1.6392,-1.6397,-1.6402,-1.6407,-1.641,-1.6413,-1.6415,-1.6417,-1.6417,-1.6415,-1.6415,-1.6414,-1.6414,-1.6413,-1.6411,-1.6408,-1.6404,-1.6401,-1.6396,-1.6392,-1.6388,-1.6383,-1.6379,-1.6373,-1.6366,-1.6359,-1.6346,-1.6342,-1.6337,-1.6329,-1.6321,-1.6314,-1.6305,-1.6298,-1.6291,-1.6281,-1.6273,-1.6264,-1.6257,-1.625,-1.6243,-1.6234,-1.6227,-1.622,-1.6212,-1.6205,-1.6197,-1.619,-1.6183,-1.6178,-1.6171,-1.6165,-1.6159,-1.6153,-1.6147,-1.614,-1.6135,-1.6131,-1.6128,-1.6122,-1.6119,-1.6115,-1.6112,-1.6108,-1.6105,-1.6102,-1.61,-1.6097,-1.6095,-1.6092,-1.6091,-1.6089,-1.6088,-1.6087,-1.6087,-1.6085,-1.6086,-1.6088,-1.6088,-1.6091,-1.6093,-1.6094,-1.6096,-1.6098,-1.61,-1.6102,-1.6104,-1.6106,-1.6109,-1.6112,-1.6115,-1.6117,-1.6119,-1.6122,-1.6126,-1.6129,-1.6134,-1.6138,-1.6142,-1.6147,-1.6151,-1.6156,-1.616,-1.6164,-1.6168,-1.6172,-1.6176,-1.6181,-1.6185,-1.619,-1.6194,-1.6198,-1.6203,-1.6207,-1.6212,-1.6216,-1.6221,-1.6225,-1.6229,-1.6233,-1.6237,-1.6242,-1.6245,-1.6249,-1.6252,-1.6257,-1.6261,-1.6265,-1.6269,-1.6273,-1.6276,-1.6279,-1.6283,-1.6283,-1.6288,-1.6292,-1.6295,-1.6298,-1.6301,-1.6307,-1.631,-1.6313,-1.6316,-1.6317,-1.632,-1.6324,-1.6327,-1.633,-1.6333,-1.6337,-1.634,-1.6344,-1.6347,-1.635,-1.6352,-1.6353,-1.6355,-1.6362,-1.6368,-1.6372,-1.6375,-1.6377,-1.638,-1.6383,-1.6386,-1.6389,-1.6393,-1.6396,-1.6399,-1.6403,-1.6405,-1.6408,-1.641,-1.6413,-1.6417,-1.6421,-1.6424,-1.6427,-1.643,-1.6432,-1.6437,-1.6441,-1.6444,-1.6447,-1.6451,-1.6454,-1.6457,-1.646,-1.6463,-1.6466,-1.6469,-1.6472,-1.6475,-1.6479,-1.6478,-1.6483,-1.6485,-1.6488,-1.6491,-1.6494,-1.6497,-1.65,-1.6504,-1.6506,-1.651,-1.6512,-1.6515,-1.6518,-1.6521,-1.6523,-1.6525]
# y = [1.0834,1.0837,1.0837,1.0837,1.084,1.0846,1.084,1.0842,1.0848,1.0855,1.086,1.0864,1.0865,1.0867,1.0861,1.0858,1.0858,1.0859,1.0859,1.0862,1.0863,1.0861,1.0859,1.0859,1.0855,1.0851,1.0848,1.0842,1.0833,1.0826,1.0818,1.0808,1.0797,1.0784,1.0771,1.0755,1.0737,1.0719,1.0703,1.068,1.0658,1.0633,1.0609,1.0582,1.055,1.0518,1.0486,1.0452,1.0417,1.0381,1.0341,1.0306,1.0177,1.0092,1.0021,0.9965,0.9918,0.9871,0.9815,0.9757,0.9696,0.964,0.9579,0.9522,0.9467,0.9394,0.9326,0.9272,0.92,0.913,0.9073,0.8999,0.8933,0.8858,0.8783,0.8725,0.8645,0.8568,0.8496,0.8427,0.8361,0.8275,0.8197,0.8121,0.8044,0.7982,0.7895,0.7824,0.774,0.7661,0.7584,0.7515,0.7432,0.7351,0.7275,0.7207,0.7124,0.7044,0.697,0.6905,0.6818,0.674,0.6664,0.6584,0.6529,0.6451,0.6374,0.6292,0.6228,0.616,0.6079,0.6015,0.5938,0.5877,0.5803,0.5731,0.5675,0.5603,0.5542,0.5477,0.541,0.5349,0.5288,0.5236,0.5177,0.5114,0.5061,0.5011,0.4952,0.4899,0.4848,0.4798,0.4755,0.4704,0.4657,0.3988,0.3979,0.3974,0.3968,0.3963,0.3957,0.3953,0.3953,0.3958,0.3959,0.3963,0.3968,0.3979,0.3986,0.3997,0.4008,0.402,0.4032,0.4046,0.4063,0.4077,0.4096,0.4114,0.4131,0.4147,0.4169,0.4189,0.4207,0.4237,0.4311,0.4363,0.4387,0.4409,0.443,0.4453,0.4477,0.4498,0.4524,0.4549,0.4573,0.4598,0.4619,0.4645,0.4671,0.4693,0.472,0.4746,0.477,0.4793,0.4816,0.484,0.4863,0.4887,0.4911,0.4932,0.4952,0.4973,0.4996,0.5014,0.5032,0.5055,0.5073,0.5089,0.5104,0.5118,0.5134,0.5149,0.5162,0.5174,0.5185,0.5196,0.5206,0.5214,0.5222,0.5229,0.5233,0.5239,0.524,0.5241,0.525,0.5237,0.5229,0.5221,0.5213,0.5201,0.5192,0.518,0.5167,0.5153,0.5138,0.5119,0.5101,0.5082,0.5062,0.504,0.502,0.4992,0.4966,0.4937,0.491,0.4881,0.4853,0.4816,0.4783,0.4746,0.4715,0.4675,0.4638,0.46,0.4554,0.451,0.4466,0.4422,0.4373,0.4329,0.4289,0.4233,0.4178,0.4125,0.4073,0.4017,0.3959,0.3912,0.3849,0.3785,0.3729,0.3671,0.3603,0.3547,0.348,0.3414,0.3348,0.3281,0.3222,0.3149,0.3078,0.3019,0.2944,0.2869,0.2795,0.2731,0.2653,0.259,0.2507,0.2429,0.235,0.2289,0.2201,0.2128,0.2044,0.1972,0.1893,0.1834,0.1746,0.1461,0.1196,0.0994,0.0892,0.0817,0.0744,0.0665,0.0589,0.0507,0.0408,0.0319,0.0228,0.0157,0.0057,-0.004,-0.0126,-0.021,-0.031,-0.0387,-0.0489,-0.0571,-0.0666,-0.0755,-0.0847,-0.0927,-0.1009,-0.1108,-0.1202,-0.1279,-0.1368,-0.146,-0.1531,-0.1624,-0.1715,-0.1788,-0.1868,-0.1964,-0.2041,-0.2122,-0.2204,-0.23,-0.2378,-0.2443,-0.2535,-0.2615,-0.2686,-0.277,-0.2853,-0.2919,-0.3006,-0.3079,-0.3162,-0.3232,-0.3305,-0.3389,-0.3469,-0.3546,-0.3618,-0.3695,-0.377,-0.3834,-0.3902,-0.3991,-0.4061,-0.4133,-0.4199,-0.4284,-0.4361,-0.4426,-0.45,-0.4569,-0.4649,-0.4712,-0.4787,-0.4865,-0.4923,-0.5004,-0.5077,-0.5152,-0.5211,-0.5288,-0.5361,-0.5437,-0.5499,-0.5573,-0.5636,-0.5732,-0.5821,-0.5905,-0.6005,-0.6077,-0.6143,-0.6202,-0.6273,-0.6346,-0.6405,-0.6481,-0.6556,-0.662,-0.67,-0.6759,-0.6841,-0.692,-0.6983,-0.7064,-0.7139,-0.7215,-0.7289,-0.7356,-0.7418,-0.7499,-0.7574,-0.7646,-0.7718,-0.7788,-0.7859,-0.793,-0.8003,-0.8076,-0.8139,-0.8216,-0.8275,-0.8351,-0.8426,-0.8494,-0.857,-0.8633,-0.8707,-0.8778,-0.8851,-0.892,-0.8989,-0.9058,-0.9129,-0.9194,-0.9255,-0.9332,-0.9398,-0.9461,-0.9526,-0.9585,-0.9664,-0.9739,-0.9804,-0.987,-0.9931,-1.0012,-1.007,-1.0144,-1.0216,-1.0278,-1.0344,-1.0413,-1.0476,-1.0536,-1.0593,-1.0669,-1.0731,-1.0806,-1.0866,-1.0935,-1.1,-1.1066,-1.1118,-1.1164,-1.1221,-1.1306,-1.1375,-1.1446,-1.1501,-1.1572,-1.1618,-1.1677,-1.175,-1.1809,-1.1869,-1.1931,-1.1988,-1.2041,-1.2107,-1.2169,-1.2221,-1.2285,-1.2342,-1.2391,-1.2457,-1.2518,-1.2569,-1.262,-1.268,-1.2734,-1.2783,-1.2836,-1.289,-1.2931,-1.2988,-1.3038,-1.3088,-1.3132,-1.3181,-1.3229,-1.3266,-1.3315,-1.336,-1.3404,-1.3441,-1.3483,-1.3525,-1.3558,-1.3601,-1.3637,-1.3673,-1.3708,-1.3742,-1.3774,-1.3806,-1.3835,-1.3863,-1.3896,-1.3926,-1.3955,-1.3977,-1.4004,-1.4025,-1.4052,-1.4074,-1.4093,-1.4111,-1.4142,-1.4171,-1.4194,-1.421,-1.4223,-1.4234,-1.4251,-1.4262,-1.4275,-1.4286,-1.4295,-1.4305,-1.4314,-1.4324,-1.4331,-1.4337,-1.4343,-1.4348,-1.4357,-1.4361,-1.4364,-1.4367,-1.437,-1.4371,-1.4373,-1.4374,-1.4374,-1.4374,-1.4372,-1.437,-1.4367,-1.4365,-1.4362,-1.4359,-1.4356,-1.4351,-1.4344,-1.4338,-1.4331,-1.4326,-1.4321,-1.4313,-1.4307,-1.4299,-1.4293,-1.4287,-1.4277,-1.4265,-1.4258,-1.4249,-1.4242,-1.4235,-1.4227,-1.422,-1.4213,-1.4207,-1.42,-1.4193,-1.4186,-1.4179,-1.4173,-1.4168,-1.4161,-1.4157,-1.4152,-1.4146,-1.4142,-1.4138,-1.4131,-1.4127,-1.4124,-1.412,-1.4117,-1.4116,-1.4114,-1.4111,-1.4108,-1.4106,-1.4106,-1.4104,-1.4103,-1.41,-1.4099,-1.4097,-1.4098,-1.4099,-1.41,-1.4096,-1.4096,-1.4101,-1.4103,-1.4108,-1.4112,-1.4115,-1.4118,-1.412,-1.4123,-1.4125,-1.4128,-1.413,-1.4132,-1.4136,-1.4139,-1.4143,-1.4146,-1.4149,-1.4153,-1.4157,-1.416,-1.4164,-1.4167,-1.417,-1.4173,-1.4177,-1.4181,-1.4185,-1.4189,-1.4193,-1.4198,-1.4199,-1.4202,-1.4206,-1.4209,-1.4213,-1.4217,-1.4222,-1.4227,-1.4231,-1.4235,-1.4238,-1.4241,-1.4245,-1.4248,-1.4252,-1.4256,-1.4263,-1.4268,-1.4272,-1.4276,-1.428,-1.4284,-1.4288,-1.4291,-1.4295,-1.4299,-1.4304,-1.4303,-1.4307,-1.4312,-1.4316,-1.4322,-1.4329,-1.4333,-1.4337,-1.4343,-1.4349,-1.4353,-1.4358,-1.4363,-1.4367,-1.4373,-1.4378,-1.4383,-1.4388,-1.4393,-1.4398,-1.4403,-1.4406,-1.441,-1.4417,-1.442,-1.4424,-1.443,-1.4434,-1.444,-1.4445,-1.4452,-1.4458,-1.4463,-1.4469,-1.4475,-1.4481,-1.4485,-1.4489,-1.4496,-1.4503,-1.4509,-1.4517,-1.4523,-1.4529,-1.4535,-1.4542,-1.4554,-1.4561,-1.4568,-1.4574,-1.458,-1.4587,-1.4593,-1.46,-1.4607,-1.4612,-1.4619,-1.4626,-1.4631,-1.4638,-1.4645,-1.4651,-1.4657,-1.4664,-1.4671,-1.4676,-1.4683,-1.4688,-1.4695,-1.4701,-1.4707,-1.4712,-1.4717,-1.4724,-1.473,-1.4735,-1.474]
# z = [0.8291,0.8293,0.8291,0.8287,0.8288,0.8289,0.8283,0.8278,0.8282,0.8277,0.8267,0.8261,0.8258,0.8256,0.8251,0.8244,0.8241,0.8239,0.8237,0.8236,0.8237,0.8235,0.8233,0.8237,0.8235,0.8233,0.8236,0.8236,0.8235,0.8237,0.8241,0.8243,0.8241,0.8243,0.8248,0.8249,0.8254,0.826,0.8262,0.8268,0.827,0.8276,0.8281,0.8283,0.8287,0.8289,0.8295,0.83,0.8305,0.8311,0.8316,0.8326,0.8339,0.8347,0.8352,0.8355,0.8365,0.837,0.8372,0.8376,0.838,0.8388,0.8397,0.8403,0.8406,0.8409,0.8418,0.8419,0.8428,0.8438,0.8442,0.845,0.8454,0.846,0.847,0.8472,0.8479,0.849,0.8497,0.8507,0.851,0.8518,0.8523,0.853,0.8541,0.8547,0.8554,0.856,0.8568,0.8573,0.8579,0.8581,0.8586,0.8593,0.8597,0.86,0.8604,0.861,0.8617,0.8619,0.8621,0.8625,0.863,0.8633,0.8637,0.8644,0.8646,0.8652,0.8655,0.8656,0.866,0.866,0.8666,0.8668,0.8672,0.8678,0.868,0.8686,0.869,0.8696,0.8699,0.8705,0.8713,0.8718,0.8724,0.8729,0.8736,0.8743,0.875,0.8756,0.8763,0.8771,0.8778,0.8787,0.8796,0.9025,0.9035,0.9046,0.9058,0.9068,0.9077,0.9088,0.9097,0.9106,0.9113,0.912,0.9129,0.9138,0.9142,0.915,0.9157,0.9163,0.9168,0.9171,0.9176,0.9181,0.9186,0.9188,0.9191,0.9194,0.9197,0.9198,0.92,0.9217,0.9225,0.9228,0.9229,0.9226,0.9226,0.9228,0.923,0.9232,0.9239,0.9248,0.9251,0.9254,0.9256,0.9256,0.9256,0.9255,0.9253,0.925,0.925,0.9249,0.9251,0.9251,0.9253,0.9258,0.9262,0.9266,0.9271,0.9276,0.928,0.9283,0.9287,0.9292,0.9295,0.9299,0.9305,0.931,0.9317,0.9323,0.933,0.9337,0.9344,0.9349,0.9354,0.9361,0.9367,0.9367,0.9371,0.9376,0.9381,0.9386,0.9388,0.9398,0.9401,0.9401,0.9405,0.9403,0.9401,0.9398,0.939,0.9389,0.9388,0.9385,0.9381,0.9377,0.9371,0.9363,0.9358,0.9352,0.9346,0.9339,0.9329,0.9322,0.9315,0.9305,0.9298,0.9288,0.928,0.9266,0.9257,0.9246,0.9234,0.9224,0.9214,0.9203,0.9191,0.9178,0.9169,0.9157,0.9144,0.9132,0.912,0.9109,0.9095,0.9087,0.9073,0.906,0.905,0.904,0.9028,0.9019,0.9007,0.8997,0.8987,0.8978,0.897,0.8961,0.895,0.8944,0.8936,0.8929,0.8921,0.8916,0.8909,0.8903,0.8896,0.8888,0.8881,0.8879,0.8873,0.8868,0.8861,0.8856,0.8851,0.8847,0.8835,0.8824,0.8809,0.8798,0.8793,0.8786,0.8789,0.8786,0.8781,0.8778,0.8773,0.8764,0.8754,0.8749,0.8743,0.8738,0.8732,0.8727,0.8718,0.8714,0.8713,0.871,0.8704,0.8699,0.8691,0.8687,0.8682,0.8678,0.8673,0.8668,0.8664,0.8654,0.865,0.8644,0.864,0.8636,0.863,0.8623,0.8617,0.861,0.8608,0.8601,0.8597,0.8587,0.8577,0.8567,0.8561,0.8553,0.8543,0.8535,0.8524,0.8515,0.8503,0.8496,0.8486,0.8475,0.8468,0.8458,0.8448,0.8439,0.8423,0.8401,0.84,0.8391,0.8383,0.8375,0.8365,0.8354,0.834,0.8332,0.8321,0.8312,0.83,0.8291,0.8284,0.8273,0.8265,0.8254,0.8245,0.8236,0.8231,0.8223,0.8216,0.8204,0.8197,0.8184,0.8186,0.8177,0.8173,0.8171,0.8167,0.8165,0.8163,0.8162,0.8161,0.8154,0.8157,0.816,0.816,0.8159,0.8159,0.8162,0.8168,0.8172,0.8176,0.8181,0.8187,0.82,0.8208,0.8213,0.8225,0.824,0.8252,0.8267,0.8281,0.8295,0.8309,0.8325,0.8341,0.8359,0.8377,0.8394,0.8414,0.8436,0.8462,0.8485,0.8513,0.8532,0.8557,0.8581,0.8603,0.8626,0.8651,0.8678,0.8699,0.8728,0.8757,0.8791,0.8819,0.8839,0.8865,0.8891,0.8925,0.8961,0.899,0.9023,0.9048,0.9079,0.9104,0.9132,0.9166,0.9223,0.9264,0.9303,0.9337,0.9362,0.9392,0.9434,0.9472,0.952,0.9558,0.96,0.9639,0.9682,0.9708,0.974,0.9781,0.9843,0.9891,0.9942,0.9982,1.0036,1.0071,1.0114,1.0168,1.0212,1.0262,1.0311,1.036,1.0404,1.0458,1.0511,1.0554,1.061,1.0656,1.0699,1.0756,1.0811,1.0857,1.0903,1.0959,1.1006,1.1053,1.1105,1.1155,1.1195,1.1249,1.1298,1.1347,1.1389,1.1436,1.1482,1.152,1.1568,1.1614,1.1658,1.1695,1.1738,1.1778,1.1812,1.1856,1.1892,1.1927,1.1963,1.1998,1.2031,1.206,1.2088,1.2118,1.2152,1.2184,1.2211,1.2232,1.2256,1.2279,1.2306,1.2322,1.2343,1.2354,1.2384,1.2417,1.244,1.2453,1.2463,1.2475,1.2489,1.25,1.2514,1.2523,1.2532,1.2542,1.2553,1.2562,1.2569,1.2577,1.2578,1.2585,1.2591,1.2593,1.2594,1.2597,1.26,1.2602,1.2608,1.2612,1.2612,1.2612,1.2611,1.261,1.2609,1.2609,1.2608,1.2607,1.2601,1.2594,1.2595,1.2591,1.2578,1.2577,1.2576,1.2571,1.2568,1.2564,1.256,1.2557,1.2551,1.2543,1.2539,1.2536,1.2534,1.2535,1.2533,1.253,1.2528,1.2528,1.2527,1.2523,1.2523,1.2524,1.2526,1.2529,1.253,1.2534,1.2537,1.254,1.2544,1.2546,1.2547,1.2551,1.2557,1.2563,1.2569,1.258,1.2593,1.2595,1.2599,1.2605,1.2612,1.262,1.2626,1.263,1.2635,1.2641,1.2647,1.2654,1.2665,1.2661,1.2675,1.269,1.2697,1.2706,1.2714,1.2716,1.2718,1.2719,1.2721,1.2723,1.2724,1.2722,1.2724,1.2724,1.2724,1.2721,1.2712,1.2711,1.2708,1.2707,1.2705,1.2701,1.2697,1.2695,1.269,1.2688,1.2685,1.2679,1.2672,1.2667,1.2662,1.2653,1.265,1.2645,1.2639,1.2636,1.263,1.2627,1.2627,1.2624,1.2619,1.2616,1.2611,1.2609,1.2606,1.2604,1.2602,1.2602,1.2602,1.2601,1.2599,1.2599,1.2598,1.2595,1.2594,1.2595,1.2596,1.2593,1.2588,1.2592,1.2593,1.2594,1.2598,1.2608,1.2609,1.2613,1.2616,1.2617,1.262,1.2625,1.2628,1.2632,1.2634,1.2638,1.2641,1.2646,1.2651,1.2653,1.2654,1.2653,1.2656,1.2663,1.2671,1.2677,1.2679,1.268,1.2681,1.2684,1.2687,1.2689,1.2691,1.2693,1.2694,1.2696,1.2694,1.2694,1.2694,1.269,1.269,1.2693,1.2694,1.2692,1.2695,1.2691,1.2693,1.2693,1.2692,1.2691,1.269,1.2689,1.2688,1.2687,1.2686,1.2686,1.2684,1.2682,1.2681,1.2679,1.2674,1.2676,1.2676,1.2677,1.2676,1.2674,1.2673,1.2672,1.2671,1.2671,1.2669,1.2669,1.2668,1.2666,1.2666,1.2665,1.2663]

# ax.plot3D(x,y,z,'b-',markersize=20, linewidth=4)
# ax.legend(handles=[
#     Line2D([], [], color='red', linewidth=1, label='Dense A* Path'),
#     Line2D([], [], color='purple', linestyle='', marker='.', markersize=8, label='Sparse Waypoints'),
#     Line2D([], [], color='black', linewidth=2, label='Trajectory'),
#     Line2D([], [], color='blue', linewidth=2, label='Actual Flight Path')],
    # loc='upper right')

ax.legend(handles=[
    Line2D([], [], color='red', linewidth=1, label='Dense A* Path'),
    Line2D([], [], color='purple', linestyle='', marker='.', markersize=8, label='Sparse Waypoints'),
    Line2D([], [], color='black', linewidth=2, label='Trajectory')],
    loc='upper right')
ax.view_init(elev=80, azim=-75)

# Position and Velocity vs. Time
(fig, axes) = plt.subplots(nrows=2, ncols=1, sharex=True, num='Position vs Time')
x = state['x']
x_des = flat['x']
ax = axes[0]
ax.plot(sim_time, x_des[:,0], 'r', sim_time, x_des[:,1], 'g', sim_time, x_des[:,2], 'b')
ax.plot(sim_time, x[:,0], 'r.',    sim_time, x[:,1], 'g.',    sim_time, x[:,2], 'b.')
ax.legend(('x', 'y', 'z'), loc='upper right')
ax.set_ylabel('position, m')
ax.grid('major')
# ax.set_title('Position| Kp: 3, 3, 19.5| Kd: 2.6, 2.6| 6, Kr: 100, 100, 20| Kw: 11, 11, 5 ')
ax.set_title('Position vs. Time')
v = state['v']
v_des = flat['x_dot']
ax = axes[1]
ax.plot(sim_time, v_des[:,0], 'r', sim_time, v_des[:,1], 'g', sim_time, v_des[:,2], 'b')
ax.plot(sim_time, v[:,0], 'r.',    sim_time, v[:,1], 'g.',    sim_time, v[:,2], 'b.')
ax.legend(('x', 'y', 'z'), loc='upper right')
ax.set_ylabel('velocity, m/s')
ax.set_xlabel('time, s')
ax.grid('major')

# Orientation and Angular Velocity vs. Time
(fig, axes) = plt.subplots(nrows=2, ncols=1, sharex=True, num='Orientation vs Time')
q_des = control['cmd_q']
q = state['q']
ax = axes[0]
ax.plot(sim_time, q_des[:,0], 'r', sim_time, q_des[:,1], 'g', sim_time, q_des[:,2], 'b', sim_time, q_des[:,3], 'k')
ax.plot(sim_time, q[:,0], 'r.',    sim_time, q[:,1], 'g.',    sim_time, q[:,2], 'b.',    sim_time, q[:,3],     'k.')
ax.legend(('i', 'j', 'k', 'w'), loc='upper right')
ax.set_ylabel('quaternion')
ax.set_xlabel('time, s')
ax.grid('major')
ax.set_title('Angular Velocity vs. Time')
w = state['w']
ax = axes[1]
ax.plot(sim_time, w[:,0], 'r.', sim_time, w[:,1], 'g.', sim_time, w[:,2], 'b.')
ax.legend(('x', 'y', 'z'), loc='upper right')
ax.set_ylabel('angular velocity, rad/s')
ax.set_xlabel('time, s')
ax.grid('major')

# Commands vs. Time
(fig, axes) = plt.subplots(nrows=3, ncols=1, sharex=True, num='Commands vs Time')
s = control['cmd_motor_speeds']
ax = axes[0]
ax.plot(sim_time, s[:,0], 'r.', sim_time, s[:,1], 'g.', sim_time, s[:,2], 'b.', sim_time, s[:,3], 'k.')
ax.legend(('1', '2', '3', '4'), loc='upper right')
ax.set_ylabel('motor speeds, rad/s')
ax.grid('major')
ax.set_title('Commands vs. Time')
M = control['cmd_moment']
ax = axes[1]
ax.plot(sim_time, M[:,0], 'r.', sim_time, M[:,1], 'g.', sim_time, M[:,2], 'b.')
ax.legend(('x', 'y', 'z'), loc='upper right')
ax.set_ylabel('moment, N*m')
ax.grid('major')
T = control['cmd_thrust']
ax = axes[2]
ax.plot(sim_time, T, 'k.')
ax.set_ylabel('thrust, N')
ax.set_xlabel('time, s')
ax.grid('major')

# 3D Paths
fig = plt.figure('3D Path')

ax.set_title('3D Path of the Quadrotor')
ax = Axes3Ds(fig)
world.draw(ax)
ax.plot([start[0]], [start[1]], [start[2]], 'go', markersize=16, markeredgewidth=3, markerfacecolor='none')
ax.plot( [goal[0]],  [goal[1]],  [goal[2]], 'ro', markersize=16, markeredgewidth=3, markerfacecolor='none')
world.draw_line(ax, flat['x'], color='black', linewidth=2)
world.draw_points(ax, state['x'], color='blue', markersize=4)
if collision_pts.size > 0:
    ax.plot(collision_pts[0,[0]], collision_pts[0,[1]], collision_pts[0,[2]], 'rx', markersize=36, markeredgewidth=4)
ax.legend(handles=[
    Line2D([], [], color='black', linewidth=2, label='Trajectory'),
    Line2D([], [], color='blue', linestyle='', marker='.', markersize=4, label='Flight')],
    loc='upper right')
ax.view_init(elev=80, azim=-75)

# Animation (Slow)
#
# Instead of viewing the animation live, you may provide a .mp4 filename to save.

import matplotlib.animation as animation
R = Rotation.from_quat(state['q']).as_matrix()
ani = animate(sim_time, state['x'], R, world=world, filename=None)

plt.show()


